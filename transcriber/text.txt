(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber> ffmpeg -version
ffmpeg version 8.0-essentials_build-www.gyan.dev Copyright (c) 2000-2025 the FFmpeg developers
built with gcc 15.2.0 (Rev8, Built by MSYS2 project)
configuration: --enable-gpl --enable-version3 --enable-static --disable-w32threads --disable-autodetect --enable-fontconfig --enable-iconv --enable-gnutls --enable-libxml2 --enable-gmp --enable-bzlib --enable-lzma --enable-zlib --enable-libsrt --enable-libssh --enable-libzmq --enable-avisynth --enable-sdl2 --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxvid --enable-libaom --enable-libopenjpeg --enable-libvpx --enable-mediafoundation --enable-libass --enable-libfreetype --enable-libfribidi --enable-libharfbuzz --enable-libvidstab --enable-libvmaf --enable-libzimg --enable-amf --enable-cuda-llvm --enable-cuvid --enable-dxva2 --enable-d3d11va --enable-d3d12va --enable-ffnvcodec --enable-libvpl --enable-nvdec --enable-nvenc --enable-vaapi --enable-openal --enable-libgme --enable-libopenmpt --enable-libopencore-amrwb --enable-libmp3lame --enable-libtheora --enable-libvo-amrwbenc --enable-libgsm --enable-libopencore-amrnb --enable-libopus --enable-libspeex --enable-libvorbis --enable-librubberband
libavutil      60.  8.100 / 60.  8.100
libavcodec     62. 11.100 / 62. 11.100
libavformat    62.  3.100 / 62.  3.100
libavdevice    62.  1.100 / 62.  1.100
libavfilter    11.  4.100 / 11.  4.100
libswscale      9.  1.100 /  9.  1.100

(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber> ffmpeg -i sample.mp3
ffmpeg version 8.0-essentials_build-www.gyan.dev Copyright (c) 2000-2025 the FFmpeg developers
  built with gcc 15.2.0 (Rev8, Built by MSYS2 project)
  configuration: --enable-gpl --enable-version3 --enable-static --disable-w32threads --disable-autodetect --enable-fontconfig --enable-iconv --enable-gnutls --enable-libxml2 --enable-gmp --enable-bzlib --enable-lzma --enable-zlib --enable-libsrt --enable-libssh --enable-libzmq --enable-avisynth --enable-sdl2 --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxvid --enable-libaom --enable-libopenjpeg --enable-libvpx --enable-mediafoundation --enable-libass --enable-libfreetype --enable-libfribidi --enable-libharfbuzz --enable-libvidstab --enable-libvmaf --enable-libzimg --enable-amf --enable-cuda-llvm --enable-cuvid --enable-dxva2 --enable-d3d11va --enable-d3d12va --enable-ffnvcodec --enable-libvpl --enable-nvdec --enable-nvenc --enable-vaapi --enable-openal --enable-libgme --enable-libopenmpt --enable-libopencore-amrwb --enable-libmp3lame --enable-libtheora --enable-libvo-amrwbenc --enable-libgsm --enable-libopencore-amrnb --enable-libopus --enable-libspeex --enable-libvorbis --enable-librubberband
  libavutil      60.  8.100 / 60.  8.100
  libavcodec     62. 11.100 / 62. 11.100
  libavformat    62.  3.100 / 62.  3.100
  libavdevice    62.  1.100 / 62.  1.100
  libavfilter    11.  4.100 / 11.  4.100
  libswscale      9.  1.100 /  9.  1.100
  libswresample   6.  1.100 /  6.  1.100
Input #0, mp3, from 'sample.mp3':
  Metadata:
    album           : CeeNaija.com
    artist          : Hillsong Worship // www.CeeNaija.com
    album_artist    : @cee_naija
    comment         : More Music @ CeeNaija.com
    encoder         : Lavf58.26.100
    genre           : CeeNaija
    title           : King Of Kings || CEENAIJA.COM
    date            : 2019
  Duration: 00:04:50.33, start: 0.023021, bitrate: 128 kb/s
  Stream #0:0: Audio: mp3 (mp3float), 48000 Hz, stereo, fltp, 128 kb/s, start 0.023021
    Metadata:
      encoder         : Lavc58.44
  Stream #0:1: Video: mjpeg (Baseline), yuvj420p(pc, bt470bg/unknown/unknown), 300x300 [SAR 1:1 DAR 1:1], 90k tbr, 90k tbn, start 0.023022 (attached pic)
      comment         : Cover (front)
At least one output file must be specified
(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber> python -V
Python 3.11.0
(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber> pip list
Package            Version
------------------ ----------
certifi            2025.11.12
charset-normalizer 3.4.4
colorama           0.4.6
filelock           3.19.1
fsspec             2025.9.0
idna               3.11
Jinja2             3.1.3
llvmlite           0.45.1
MarkupSafe         2.1.5
more-itertools     10.8.0
mpmath             1.3.0
networkx           3.5
numba              0.62.1
numpy              2.3.3
openai-whisper     20250625
pillow             11.3.0
pip                22.3
regex              2025.11.3
requests           2.32.5
setuptools         65.5.0
sympy              1.13.1
tiktoken           0.12.0
torch              2.5.1+cpu
torchaudio         2.5.1+cpu
torchvision        0.20.1+cpu
tqdm               4.67.1
typing_extensions  4.9.0
urllib3            2.5.0

[notice] A new release of pip available: 22.3 -> 25.3
[notice] To update, run: python.exe -m pip install --upgrade pip


import whisper
import subprocess
import sys
import os

AUDIO_FILE = "audio.m4a"   # change to your file

print("==== WHISPER DEBUG SCRIPT ====")

# 1. Check file exists
if not os.path.exists(AUDIO_FILE):
    print(f"ERROR: File not found -> {AUDIO_FILE}")
    sys.exit(1)

print(f"[OK] File exists: {AUDIO_FILE}")

# 2. Test ffmpeg manually
print("\n[TEST] Running ffmpeg to decode audio...")
try:
    result = subprocess.run(
        ["ffmpeg", "-i", AUDIO_FILE, "-f", "wav", "-"],
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
        text=True
    )
    print("[OK] ffmpeg responded.")
except Exception as e:
    print(f"[ERROR] ffmpeg failed: {e}")
    sys.exit(1)

# If ffmpeg printed errors in stderr that indicate a decode issue
if "Error" in result.stderr or "Invalid" in result.stderr:
    print("\n[ERROR] FFmpeg cannot decode this audio file!")
    print(result.stderr)
    sys.exit(1)

print("[OK] ffmpeg can decode the audio.\n")

# 3. Load model
print("Loading Whisper model... (this takes some seconds on CPU)")
try:
    model = whisper.load_model("base")  # small enough for CPU
    print("[OK] Model loaded.\n")
except Exception as e:
    print(f"[ERROR] Failed to load Whisper: {e}")
    sys.exit(1)

# 4. Transcribe
print("Transcribing now...\n")
try:
    result = model.transcribe(AUDIO_FILE, fp16=False)
    print("\n==== TRANSCRIPTION OUTPUT ====")
    print(result["text"])
    print("\n==== DONE ====")
except Exception as e:
    print(f"[ERROR] Transcription failed: {e}")
    sys.exit(1)

(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber> python transcribe.py
==== WHISPER DEBUG SCRIPT ====
[OK] File exists: sample.mp3

[TEST] Running ffmpeg to decode audio...
Exception in thread Thread-1 (_readerthread):
Traceback (most recent call last):
  File "C:\Users\gbeng\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1038, in _bootstrap_inner
    self.run()
  File "C:\Users\gbeng\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 975, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\gbeng\AppData\Local\Programs\Python\Python311\Lib\subprocess.py", line 1550, in _readerthread
    buffer.append(fh.read())
                  ^^^^^^^^^
  File "C:\Users\gbeng\AppData\Local\Programs\Python\Python311\Lib\encodings\cp1252.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'charmap' codec can't decode byte 0x9d in position 189176: character maps to <undefined>
[OK] ffmpeg responded.
[OK] ffmpeg can decode the audio.

Loading Whisper model... (this takes some seconds on CPU)
[OK] Model loaded.

Transcribing now...

(venv) PS C:\Vision\files\Java\Koinonia-Daily\transcriber>